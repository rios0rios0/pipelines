parameters:
  - name: 'TAG_NAME'
    type: 'string'

steps:
  - template: 'corepack-node20.18.3-no-cache.yaml'

  - script: |
      git clone --depth 1 --branch ${{ parameters.TAG_NAME }} https://github.com/opensearch-project/OpenSearch-Dashboards.git $(Agent.TempDirectory)/OpenSearch-Dashboards
    displayName: 'Clone OpenSearch Dashboards repository'

  - task: 'Cache@2'
    inputs:
      key: "$(Agent.JobName)|$(Agent.TempDirectory)/OpenSearch-Dashboards/yarn.lock"
      path: "$(Agent.TempDirectory)/OpenSearch-Dashboards/node_modules"
    displayName: 'Cache for "node_modules" (OpenSearch Dashboards)'
    continueOnError: true
